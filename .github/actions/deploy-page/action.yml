name: 'Configure Git'
description: 'Configure Git'
author: jtacopt

inputs:
  branch:
    description: 'GitHub Pages Branch'
    default: 'gh_page'
    required: false
  artifact-name:
    description: 'Page Artifact Source'
    required: true
  path:
    description: 'Page Path'
    default: ''
    required: true

runs:
  using: composite

  steps:
    - name: Checkout
      uses: actions/checkout@v4
      with:
        ref: ${{ inputs.branch }}

    - name: Get Page Artifact
      uses: actions/download-artifact@v3
      with:
        name: ${{ inputs.artifact-name }}
        path: ${{ inputs.path }}

    - name: Deploy Page
      shell: bash
      run: |
        git config --global user.email "jtacopt@gmail.com"
        git config --global user.name "Jo√£o Carvalho"
        git remote set-url origin https://x-access-token:${{ secrets.PAT }}@github.com/${{ github.repository }}
        git add ${{ inputs.path }}
        git commit -m "Allure Report | ${{ inputs.path }} | ${{ github.run_number }}"
        git push
